<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Ã‡oklu Soru Tipli Quiz</title>
<meta name="description" content="FarklÄ± soru tÃ¼rleri, anÄ±nda geri bildirim ve sÃ¼reli Ã¼cretsiz quiz.">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
<script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']] // $...$ ve \(...\) satÄ±r iÃ§i iÃ§in
      },
      svg: {
        fontCache: 'global'
      }
    };
</script>



<style>
/* Genel SÄ±fÄ±rlama ve Font */
body {
  font-family: "Inter", system-ui, sans-serif;
  background: #f6f7fb;
  max-width: 760px;
  margin: auto;
  padding: 20px;
}
h1 { margin-bottom: 5px; }

/* Ä°lerleme Ã‡ubuÄŸu ve Kart */
.progress { font-size: .9rem; color: #666; margin-bottom: 10px; }

.quiz-card {
  background: #fff;
  border-radius: 14px;
  padding: 24px;
  box-shadow: 0 15px 35px rgba(0,0,0,.08);
}

.question { 
  font-size: 1.1rem; 
  font-weight: 600; 
  margin-bottom: 15px; 
}

/* SeÃ§enekler ve Butonlar */
.option, button {
  display: block;
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  background: #f1f3f8;
  border: none;
  border-radius: 10px;
  padding: 12px 15px;
  margin: 8px 0;
  cursor: pointer;
  transition: .2s;
  text-align: left;
  font-size: 1rem;
  font-weight: 500;
}

/* Cevapla/GÃ¶nder ButonlarÄ± iÃ§in Ã¶zel stil */
button {
  /* GeniÅŸlik ayarÄ± deÄŸiÅŸtirildi */
  width: 100%; 
  max-width: 100%; /* Tam geniÅŸliÄŸi zorla (Ã¶nceki max-width: 300px kaldÄ±rÄ±ldÄ±) */
  
  background: #4caf50;
  color: white;
  text-align: center;
  margin-top: 15px;
  font-weight: 600;
  margin-left: 0;
  margin-right: 0; /* Otomatik margin kaldÄ±rÄ±ldÄ± */
}

.option:hover { background: #e0e4f1; }
button:hover { background: #43a047; }
.option.correct { background: #d4edda; border: 1px solid #c3e6cb; }
.option.wrong { background: #f8d7da; border: 1px solid #f5c6cb; }

/* Sonraki Butonu (Mavi) */
#nextBtn {
    background: #007bff; /* Mavi renk */
}
#nextBtn:hover {
    background: #0056b3; /* Koyu Mavi hover */
}

/* Form Elementleri (input, textarea, select) */
input, textarea, select {
  font-size: 1rem;
  padding: 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  margin-top: 8px;
  box-sizing: border-box; 
  display: block;
}

/* input'a (kÄ±sa cevap) tam geniÅŸlik kuralÄ± */
input {
  width: 100%; 
  max-width: 100%;
}

/* Geri Bildirim */
.feedback {
  margin-top: 15px;
  padding: 12px;
  border-radius: 10px;
  font-weight: 600;
}
.feedback.correct { background: #e6f7ee; color: #1e7e34; }
.feedback.wrong { background: #fdecea; color: #b71c1c; }
.feedback.note { background: #e3f2fd; color: #1565c0; }

/* Zaman Ã‡ubuÄŸu */
.time-bar {
  height: 6px;
  background: #eee;
  border-radius: 3px;
  overflow: hidden;
  margin: 12px 0;
}
#timeFill {
  height: 100%;
  background: linear-gradient(90deg, #4caf50, #ff9800);
  width: 100%;
  transition: width 1s linear;
}

/* SÄ±ralama listesi Ã¶zel */
ul.drag-list { list-style: none; padding: 0; margin: 0; }
.option.draggable::before {
  content: "â˜°";
  display: inline-block;
  width: 20px;
  margin-right: 10px;
  cursor: grab;
  color: #888;
}
.option.draggable.dragging {
  cursor: grabbing;
  opacity: 0.6;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  transform: rotate(1deg);
}

/* EÅŸleÅŸtirme Sorusu Ã–zel (Geleneksel) */
.match-item {
  display: flex;
  align-items: center; 
  margin: 12px 0;
  font-size: 1rem;
  gap: 10px; 
  font-weight: 500;
}

/* YENÄ° KRÄ°TÄ°K KURAL: Sol metin iÃ§in sabit bir kapsayÄ±cÄ± oluÅŸturuyoruz */
.match-item-left {
  /* GeniÅŸliÄŸi, olasÄ± en uzun metni (Ã¶rn: "TÃ¼rkiye") rahatÃ§a alabilecek ÅŸekilde belirleyin. */
  min-width: 120px; 
  text-align: right; /* SeÃ§im kutusuna yaklaÅŸmasÄ± iÃ§in saÄŸa hizala */
  padding-right: 10px; 
}

.match-item select {
  margin: 0;
  max-width: 200px;
  flex-grow: 1; /* SeÃ§im kutusunun kalan alanÄ± doldurmasÄ±nÄ± saÄŸlar */
}

/* SÃœRKLE-BIRAK EÅLEÅTÄ°RME CSS'Ä° */
.drag-match-container {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 20px;
  margin-top: 15px;
}
.left-column, .right-column {
  flex: 1;
  min-width: 150px;
  border-radius: 10px;
  transition: background-color 0.2s;
  padding: 5px;
}
.right-column {
  list-style: none;
  padding: 0;
  margin: 0;
}
.right-column li {
  margin-bottom: 10px;
}
/* *** DÃœZELTME 1: SÃœRÃœKLENEN Ã–ÄE YÃœKSEKLÄ°ÄÄ° *** */
.match-item-drag {
  cursor: grab;
  text-align: center;
  margin-bottom: 10px; 
  
  /* YUMUÅATILMIÅ RENK: Amber / Pastel SarÄ± */
  background: #ffecb3; /* Ã‡ok aÃ§Ä±k pastel sarÄ± (Ã–nceki: #ffc107) */
  color: #555; /* Metin rengi koyu gri (daha yumuÅŸak) */
  
  padding: 8px 15px; 
  border-radius: 8px;
  font-weight: 600;
  box-sizing: border-box;
  min-height: 48px;
  display: flex;
  align-items: center; 
  justify-content: center; 
}

/* 2. BÄ±rakma AlanlarÄ± (Drop Target) - DAHA AÃ‡IK ZEMÄ°N */
.drop-target {
  /* BaÅŸlangÄ±Ã§: #fffbe6 idi, daha da aÃ§alÄ±m */
  background: #fff8e1; /* En aÃ§Ä±k krem/sarÄ± tonu */
  border: 2px dashed #ffecb3; /* match-item-drag ile aynÄ± aÃ§Ä±k sarÄ± kenarlÄ±k */
  border-radius: 10px;
  padding: 8px 15px; 
  min-height: 48px; 
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 500;
  transition: all 0.2s;
  box-sizing: border-box;
}

/* 3. SÃ¼rÃ¼kleme Ãœzerindeyken (Drag Over) */
.drop-target.drag-over {
  border-color: #ffb300; /* Orta sarÄ± kenarlÄ±k */
  background: #fff3cd; /* Hafif sarÄ± tonu (Daha az agresif) */
  box-shadow: 0 0 10px rgba(255, 179, 0, 0.3);
}

/* 4. Dolu Hedefin Rengi (Filled) */
.drop-target.filled {
    border: 2px solid #ffb300; /* Daha aÃ§Ä±k sarÄ±/turuncu kenarlÄ±k */
    justify-content: flex-start;
    padding: 0; 
}

/* Dolu hedefin iÃ§indeki sÃ¼rÃ¼klenen Ã¶ÄŸe */
.drop-target.filled .match-item-drag {
    margin: 0;
    width: 100%;
    border-radius: 8px;
    background: #ffb300; /* Hafif koyu sarÄ± (Doluluk belirtisi) */
    cursor: default;
    min-height: 48px;
    color: white; /* Okunurluk iÃ§in metin rengini beyaza Ã§eviriyoruz */
}
/* SonuÃ§ Ã‡ubuÄŸu */
.result-bar { background: #eee; border-radius: 10px; height: 14px; margin-top: 12px; overflow: hidden; }
.result-correct { height: 100%; background: linear-gradient(90deg, #4caf50, #8bc34a); }

@media (max-width: 600px) {
  body { padding: 12px; }
  h1 { font-size: 1.4rem; }
  input, textarea, select, .option, button { max-width: 100%; }
  .drag-match-container { flex-direction: column; }
}
</style>
</head>

<body>

<h1>Ã‡oklu Soru Tipli Quiz</h1>
<p>FarklÄ± soru tipleri, anÄ±nda geri bildirim ve sÃ¼reli yapÄ±.</p>

<div class="progress">
  Soru <span id="current">1</span> / <span id="total">5</span>
</div>

<div class="quiz-card">
  <div class="time-bar"><div id="timeFill"></div></div>
  <div id="quiz"></div>
  <div id="feedback" class="feedback"></div>
  <button id="nextBtn" style="display:none">Sonraki Soru</button>
</div>

<script>
const questions = [
  { type: "multiple", question: "$3^2$ aÅŸaÄŸÄ±dakilerden hangisine eÅŸittir?", options: ["3", "6", "9","12"], correct_answer: "9", time: 10 },
  { type: "short", question: "TÃ¼rkiye'nin baÅŸkenti nedir?", answers: ["ankara"], time: 10, explanation: "TÃ¼rkiye'nin baÅŸkenti Ankara'dÄ±r." },
  { type: "order", question: "KÃ¼Ã§Ã¼kten bÃ¼yÃ¼ÄŸe sÄ±rala:", items: ["10", "2", "5"], correct: ["2", "5", "10"], time: 15 },
  { type: "match", question: "Ãœlkeleri baÅŸkentleriyle eÅŸleÅŸtir (SeÃ§meli):", pairs: [{ left: "TÃ¼rkiye", right: "Ankara" }, { left: "Fransa", right: "Paris" }], time: 20 },
  { type: "drag-match", question: "Åehirleri Ã¼lkeleriyle eÅŸleÅŸtir (SÃ¼rÃ¼kle-BÄ±rak):", pairs: [{ left: "Ä°stanbul", right: "TÃ¼rkiye" }, { left: "Berlin", right: "Almanya" }, { left: "Madrid", right: "Ä°spanya" }], time: 25 }
];

let index = 0;
let timer;
let timeLeft;
let correctCount = 0;
let totalCount = 0;

const quizEl = document.getElementById("quiz");
const feedbackEl = document.getElementById("feedback");
const nextBtn = document.getElementById("nextBtn");
const currentEl = document.getElementById("current");
const totalEl = document.getElementById("total");
const timeFill = document.getElementById("timeFill");

totalEl.textContent = questions.length; 

function normalize(text) {
  return text.toLowerCase().trim().replace(/\s+/g, " ");
}

function startTimer(seconds) {
  clearInterval(timer);
  timeLeft = seconds;
  updateBar(seconds);
  timer = setInterval(() => {
    timeLeft--;
    updateBar(seconds);
    if (timeLeft <= 0) {
      clearInterval(timer);
      showFeedback(false, "â° SÃ¼re doldu! DoÄŸru cevap verilemedi.");
    }
  }, 1000);
}

function updateBar(total) {
  timeFill.style.width = (timeLeft / total) * 100 + "%";
}

function showFeedback(correct, text) {
  if (correct !== null) {
    totalCount++;
    if (correct) correctCount++;
  }
  feedbackEl.textContent = text;
  const feedbackClass = correct === true ? "correct" : (correct === false ? "wrong" : "note");
  feedbackEl.className = "feedback " + feedbackClass;
  nextBtn.style.display = "block";
}

function loadQuestion() {
  quizEl.innerHTML = "";
  feedbackEl.textContent = "";
  feedbackEl.className = "feedback";
  nextBtn.style.display = "none";

  const q = questions[index];
  currentEl.textContent = index + 1;

  startTimer(q.time);

  const title = document.createElement("div");
  title.className = "question";
  title.textContent = q.question;
  quizEl.appendChild(title);

  // Ã‡OKTAN SEÃ‡MELÄ°
// Ã‡OKTAN SEÃ‡MELÄ° - CEVAP DEÄERÄ° VE RASTGELE SIRALAMA Ä°LE
if (q.type === "multiple") {
    // Ã–nceki: const correctAnswer = q.options[q.answer];
    // YENÄ°: DoÄŸru cevabÄ± doÄŸrudan correct_answer alanÄ±ndan alÄ±yoruz
    const correctAnswer = q.correct_answer; // <--- BurasÄ± deÄŸiÅŸti!
    
    // 2. SeÃ§enekleri rastgele karÄ±ÅŸtÄ±r
    const shuffledOptions = [...q.options];
    for (let i = shuffledOptions.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [shuffledOptions[i], shuffledOptions[j]] = [shuffledOptions[j], shuffledOptions[i]];
    }
    
    // 3. KarÄ±ÅŸtÄ±rÄ±lmÄ±ÅŸ seÃ§enekleri DOM'a ekle
    shuffledOptions.forEach(opt => {
      const btn = document.createElement("div");
      btn.className = "option";
      btn.textContent = opt;
      
      // CevabÄ± direkt olarak butonun data Ã¶zelliÄŸine kaydet
      const isCorrect = opt === correctAnswer;
      btn.dataset.correct = isCorrect; 
      
      btn.onclick = (e) => {
        clearInterval(timer);
        
        // TÃ¼m butonlarÄ±n tÄ±klama Ã¶zelliÄŸini kapat
        Array.from(quizEl.querySelectorAll('.option')).forEach(o => o.onclick = null);

        const clickedIsCorrect = e.target.dataset.correct === "true";
        e.target.classList.add(clickedIsCorrect ? "correct" : "wrong");
        
        // DoÄŸru cevabÄ± iÅŸaretle (EÄŸer yanlÄ±ÅŸ cevaplandÄ±ysa)
        if (!clickedIsCorrect) {
            // DoÄŸru cevabÄ± bul ve iÅŸaretle
            const correctButton = Array.from(quizEl.querySelectorAll('.option')).find(o => o.dataset.correct === "true");
            if (correctButton) {
                correctButton.classList.add("correct");
            }
        }
        
        // Geri bildirim mesajÄ±nÄ± gÃ¼ncelle
        const feedbackMessage = clickedIsCorrect 
            ? "âœ… DoÄŸru!" 
            : `âŒ YanlÄ±ÅŸ cevap. DoÄŸru cevap: ${correctAnswer}`; // <-- YENÄ° MESAJ
        
        showFeedback(clickedIsCorrect, feedbackMessage);
      };
      quizEl.appendChild(btn);
    });
  }

  // KISA CEVAP (Short Answer)
  if (q.type === "short") {
    const input = document.createElement("input");
    input.placeholder = "KÄ±sa cevabÄ±nÄ±zÄ± yazÄ±n";
    const btn = document.createElement("button");
    btn.textContent = "CevabÄ± Onayla";
    btn.onclick = () => {
      clearInterval(timer);
      const userAnswer = normalize(input.value);
      const isCorrect = q.answers.some(a => normalize(a) === userAnswer);
      
      btn.disabled = true;
      
      const feedbackMessage = isCorrect 
          ? "âœ… DoÄŸru!" 
          : `âŒ YanlÄ±ÅŸ. DoÄŸru cevap: ${q.answers[0]}`; // <-- YENÄ° MESAJ
      
      showFeedback(isCorrect, feedbackMessage);
    };
    quizEl.append(input, btn);
  }

  // SIRALAMA (Order)
  if (q.type === "order") {
    const list = document.createElement("ul");
    list.className = "drag-list";
    const items = q.items.sort(() => Math.random() - 0.5); 

    items.forEach(item => {
      const li = document.createElement("li");
      li.textContent = item;
      li.className = "option draggable";
      li.draggable = true;
      li.style.marginBottom = "8px";

      li.addEventListener("dragstart", e => {
        e.dataTransfer.setData("text/plain", e.target.textContent);
        li.classList.add("dragging");
      });
      li.addEventListener("dragend", e => {
        li.classList.remove("dragging");
      });
      list.addEventListener("dragover", e => { e.preventDefault(); });
      li.addEventListener("dragover", e => {
        e.preventDefault();
        const dragging = document.querySelector(".dragging");
        if (dragging && dragging !== li) {
          const rect = li.getBoundingClientRect();
          const next = (e.clientY - rect.top) / rect.height > 0.5;
          li.parentNode.insertBefore(dragging, next ? li.nextSibling : li);
        }
      });

      list.appendChild(li);
    });

    quizEl.appendChild(list);

    const btn = document.createElement("button");
    btn.textContent = "SÄ±ralamayÄ± Onayla";
    btn.onclick = () => {
      clearInterval(timer);
      btn.disabled = true;
      const userOrder = Array.from(list.children).map(li => li.textContent);
      const ok = JSON.stringify(userOrder) === JSON.stringify(q.correct);
      
      list.style.pointerEvents = 'none'; 

      const feedbackMessage = ok 
          ? "âœ… DoÄŸru sÄ±ralama!" 
          : `âŒ YanlÄ±ÅŸ. DoÄŸru sÄ±ralama: ${q.correct.join(" â†’ ")}`; // <-- YENÄ° MESAJ

      showFeedback(ok, feedbackMessage);
    };
    quizEl.appendChild(btn);
  }

// EÅLEÅTÄ°RME (Geleneksel Selectbox) - (SeÃ§enekler KarÄ±ÅŸtÄ±rÄ±lmÄ±ÅŸ ve SeÃ§im Kutusu DÃ¼zeltildi)
  if (q.type === "match") {
    
    // SaÄŸ taraftaki tÃ¼m cevaplarÄ± al ve rastgele karÄ±ÅŸtÄ±r
    const rightOptions = q.pairs.map(p => p.right).sort(() => Math.random() - 0.5);

    q.pairs.forEach(pair => {
      const wrap = document.createElement("div");
      wrap.className = "match-item"; 
      
      // 1. Sol Metin KapsayÄ±cÄ±sÄ± (Ã–nceki hizalama dÃ¼zeltmesinden geldi)
      const leftContainer = document.createElement("div");
      leftContainer.className = "match-item-left";
      
      const leftText = document.createElement("span");
      leftText.textContent = pair.left + " â†’ ";
      
      leftContainer.appendChild(leftText); 
      
      // 2. SeÃ§im Kutusu OluÅŸturma
      const select = document.createElement("select");
      
      const defaultOption = document.createElement("option");
      defaultOption.textContent = "SeÃ§iniz...";
      defaultOption.value = "";
      select.appendChild(defaultOption);

      // KRÄ°TÄ°K DÃœZELTME: KarÄ±ÅŸtÄ±rÄ±lmÄ±ÅŸ tÃ¼m seÃ§enekleri seÃ§im kutusuna ekle
      rightOptions.forEach(r => {
        const o = document.createElement("option");
        o.textContent = r;
        o.value = r; 
        select.appendChild(o);
      });
      
      wrap.appendChild(leftContainer); // Sabit geniÅŸlikli sol metin
      wrap.appendChild(select);
      quizEl.appendChild(wrap);
    });
    
    const btn = document.createElement("button");
    btn.textContent = "EÅŸleÅŸtirmeyi Onayla"; // <-- Metin gÃ¼ncellendi
    btn.onclick = () => {
      clearInterval(timer);
      btn.disabled = true;
      const selects = quizEl.querySelectorAll("select");
      let allMatched = true;
      
      selects.forEach((s, i) => { 
        // Sol taraftaki Ã¶ÄŸe (pair.left) her zaman q.pairs dizisindeki orijinal sÄ±rasÄ±ndadÄ±r.
        // DoÄŸru cevap q.pairs[i].right olmalÄ±dÄ±r.
        const isCorrect = s.value === q.pairs[i].right;
        if (!isCorrect) {
          allMatched = false;
        }
        
        // HatalÄ±ysa doÄŸru cevabÄ± gÃ¶ster
        const correctValue = q.pairs[i].right;
        
        s.style.backgroundColor = isCorrect ? '#d4edda' : '#f8d7da';
        s.style.border = isCorrect ? '1px solid #c3e6cb' : '1px solid #f5c6cb';
        s.disabled = true; 
        
        // YanlÄ±ÅŸ cevap verildiÄŸinde doÄŸru seÃ§eneÄŸi iÅŸaretle
        if (!isCorrect) {
            // Sadece gÃ¶rsel olarak belirtmek iÃ§in, yanlÄ±ÅŸ cevabÄ± seÃ§ilmemiÅŸse bile 
            // doÄŸru cevabÄ± metin olarak gÃ¶stermek daha aÃ§Ä±klayÄ±cÄ±dÄ±r.
            // (Select kutusunun deÄŸerini deÄŸiÅŸtirmek kullanÄ±cÄ±ya neyi seÃ§tiÄŸini gÃ¶stereceÄŸinden, 
            // sadece rengi deÄŸiÅŸtirmek yeterli olacaktÄ±r.)
        }
      });
      
      const feedbackMessage = allMatched 
          ? "âœ… TÃ¼m eÅŸleÅŸtirmeler doÄŸru!" 
          : "âŒ BazÄ± eÅŸleÅŸtirmeler yanlÄ±ÅŸ. YanlÄ±ÅŸ olanlarÄ± dÃ¼zeltmeniz gerekir.";
      
      showFeedback(allMatched, feedbackMessage);
    };
    quizEl.appendChild(btn);
  }
  
  // SÃœRKLE-BIRAK EÅLEÅTÄ°RME (Drag Match) - GÃœVENÄ°LÄ°R SÃœRÃœM
  if (q.type === "drag-match") {
    const draggableItems = q.pairs.map(p => p.left).sort(() => Math.random() - 0.5);
    const dropTargets = q.pairs.map(p => p.right).sort(() => Math.random() - 0.5);

    const container = document.createElement("div");
    container.className = "drag-match-container";
    
    const leftCol = document.createElement("div");
    leftCol.className = "left-column";
    
    const rightCol = document.createElement("ul");
    rightCol.className = "right-column";

    const targetMap = {}; 
    
    // Sol SÃ¼tun GÃ¶rsel Ä°puÃ§larÄ±
    leftCol.addEventListener("dragover", e => {
        e.preventDefault();
        leftCol.style.backgroundColor = '#e0e4f1'; 
    });

    leftCol.addEventListener("dragleave", e => {
        leftCol.style.backgroundColor = 'transparent';
    });


    // 1. Sol Kolonu (SÃ¼rÃ¼klenen Ã–ÄŸeler) OluÅŸtur
    draggableItems.forEach(item => {
        const dragItem = document.createElement("div");
        dragItem.textContent = item;
        dragItem.className = "match-item-drag";
        dragItem.draggable = true;
        dragItem.id = `drag-${item}`; 

        dragItem.addEventListener("dragstart", e => {
            const dragItem = e.target;
            e.dataTransfer.setData("text/plain", item);
            
            const parentTarget = dragItem.parentNode;

            // Ã–ÄŸeyi direkt sol sÃ¼tuna geri taÅŸÄ±ma (Ã–nceki Ã§Ã¶zÃ¼m)
            if (parentTarget.classList.contains("drop-target")) {
                parentTarget.classList.remove("filled");
                parentTarget.textContent = parentTarget.dataset.targetName;
            }
            leftCol.appendChild(dragItem);
            dragItem.style.display = 'block'; 
            
            // *** YENÄ° Ã‡Ã–ZÃœM: SÃ¼rÃ¼kleme Resmini Ayarlama ***
            // Drag item'i kullan, farenin tam merkezine hizala (geniÅŸliÄŸin/yÃ¼ksekliÄŸin yarÄ±sÄ±)
            const itemRect = dragItem.getBoundingClientRect();
            e.dataTransfer.setDragImage(dragItem, itemRect.width / 2, itemRect.height / 2);
            // **********************************************

            // SÃ¼rÃ¼kleme sÄ±rasÄ±nda Ã¶ÄŸeyi anlÄ±k gizle
            setTimeout(() => dragItem.style.display = 'none', 0); 
        });
        
        dragItem.addEventListener("dragend", e => {
            // SÃ¼rÃ¼kleme iptal edilirse, Ã¶ÄŸenin gÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼nÃ¼ geri getir.
             if (e.target.style.display === 'none') {
                 e.target.style.display = 'block';
             }
        });

        leftCol.appendChild(dragItem);
    });

    // 2. SaÄŸ Kolonu (BÄ±rakma Hedefleri) OluÅŸtur
    dropTargets.forEach(targetName => {
        const li = document.createElement("li");
        
        const targetEl = document.createElement("div");
        targetEl.className = "drop-target";
        targetEl.textContent = targetName;
        targetEl.dataset.targetName = targetName; 
        
        targetMap[targetName] = targetEl; 
        
        targetEl.addEventListener("dragover", e => {
            e.preventDefault();
            if (!targetEl.classList.contains("filled")) {
                 targetEl.classList.add("drag-over");
            }
        });
        
        targetEl.addEventListener("dragleave", e => {
            targetEl.classList.remove("drag-over");
        });
        
        targetEl.addEventListener("drop", e => {
            e.preventDefault();
            targetEl.classList.remove("drag-over");
            
            const draggedText = e.dataTransfer.getData("text/plain");
            const draggedItem = document.getElementById(`drag-${draggedText}`);
            
            // Hedef doluysa geri Ã§evir
            if (targetEl.classList.contains("filled")) {
                return;
            }

            // Ã–ÄŸeyi hedefin iÃ§ine taÅŸÄ±
            targetEl.innerHTML = "";
            targetEl.appendChild(draggedItem);
            targetEl.classList.add("filled");
            
            // Ã–ÄŸeyi gÃ¶rÃ¼nÃ¼r yap
            draggedItem.style.display = 'block'; 
        });

        li.appendChild(targetEl);
        rightCol.appendChild(li);
    });
    
    container.append(leftCol, rightCol);
    quizEl.appendChild(container);
    
    const btn = document.createElement("button");
    btn.textContent = "EÅŸleÅŸtirmeyi Onayla";
    btn.onclick = () => {
        clearInterval(timer);
        btn.disabled = true;

        let allCorrect = true;
        
        // EÅŸleÅŸtirmeleri Kontrol Et
        q.pairs.forEach(pair => {
            const dropTarget = targetMap[pair.right]; 
            
            if (dropTarget && dropTarget.classList.contains("filled")) {
                const draggedItem = dropTarget.querySelector(".match-item-drag");
                
                if (draggedItem && draggedItem.textContent === pair.left) {
                    draggedItem.style.backgroundColor = '#1e7e34'; 
                } else {
                    allCorrect = false;
                    if (draggedItem) draggedItem.style.backgroundColor = '#b71c1c'; 
                    else dropTarget.style.backgroundColor = '#f8d7da';
                }
            } else {
                allCorrect = false;
                if (dropTarget) dropTarget.style.backgroundColor = '#f8d7da';
            }
        });

        const feedbackMessage = allCorrect 
          ? "âœ… TÃ¼m eÅŸleÅŸtirmeler doÄŸru!" 
          : "âŒ BazÄ± eÅŸleÅŸtirmeler yanlÄ±ÅŸ. YanlÄ±ÅŸ eÅŸleÅŸmeler kÄ±rmÄ±zÄ± ile gÃ¶sterildi."; // <-- Genel mesaj korundu

      showFeedback(allCorrect, feedbackMessage);
    };
    quizEl.appendChild(btn);
  }
}

nextBtn.onclick = () => {
  index++;
  if (index < questions.length) {
    loadQuestion();
  } else {
    clearInterval(timer);
    const successRate = totalCount > 0 ? (correctCount / totalCount) * 100 : 0;
    quizEl.innerHTML = `
      <h2>Quiz Bitti ğŸ‰</h2>
      <p>Toplam <strong>${questions.length}</strong> soru vardÄ±.</p>
      <p>DeÄŸerlendirilen <strong>${totalCount}</strong> sorudanÂ 
      <strong>${correctCount}</strong> tanesini doÄŸru yaptÄ±n.</p>
      <div class="result-bar">
        <div class="result-correct" style="width:${successRate}%"></div>
      </div>
      <p style="text-align:center; font-weight:700; margin-top:20px;">BaÅŸarÄ± OranÄ±n: ${successRate.toFixed(1)}%</p>
    `;
    feedbackEl.textContent = "";
    feedbackEl.className = "feedback";
    nextBtn.style.display = "none";
    timeFill.style.width = "0%";
    document.querySelector(".progress").style.display = "none";
  }
};

loadQuestion();
</script>

</body>
</html>
